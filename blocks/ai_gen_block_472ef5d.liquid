{% doc %}
  @prompt
    create testimonail section with dummy content. make that section with slider deskop 3 columns and mobile view one column
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-testimonial-slider-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    padding: 60px 20px;
    background-color: {{ block.settings.background_color }};
  }

  .ai-testimonial-slider__container-{{ ai_gen_id }} {
    max-width: 1200px;
    margin: 0 auto;
  }

  .ai-testimonial-slider__header-{{ ai_gen_id }} {
    text-align: center;
    margin-bottom: 50px;
  }

  .ai-testimonial-slider__title-{{ ai_gen_id }} {
    font-size: {{ block.settings.title_size }}px;
    color: {{ block.settings.title_color }};
    margin: 0 0 15px;
  }

  .ai-testimonial-slider__subtitle-{{ ai_gen_id }} {
    font-size: {{ block.settings.subtitle_size }}px;
    color: {{ block.settings.subtitle_color }};
    margin: 0;
  }

  .ai-testimonial-slider__track-wrapper-{{ ai_gen_id }} {
    position: relative;
    overflow: hidden;
  }

  .ai-testimonial-slider__track-{{ ai_gen_id }} {
    display: flex;
    gap: 20px;
    transition: transform 0.5s ease;
  }

  .ai-testimonial-slider__slide-{{ ai_gen_id }} {
    flex: 0 0 calc(33.333% - 14px);
    background-color: {{ block.settings.card_background }};
    border-radius: {{ block.settings.card_border_radius }}px;
    padding: 30px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  }

  .ai-testimonial-slider__rating-{{ ai_gen_id }} {
    display: flex;
    gap: 5px;
    margin-bottom: 15px;
  }

  .ai-testimonial-slider__star-{{ ai_gen_id }} {
    width: 20px;
    height: 20px;
    color: {{ block.settings.star_color }};
  }

  .ai-testimonial-slider__quote-{{ ai_gen_id }} {
    font-size: 16px;
    line-height: 1.6;
    color: {{ block.settings.quote_color }};
    margin-bottom: 20px;
  }

  .ai-testimonial-slider__author-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .ai-testimonial-slider__avatar-{{ ai_gen_id }} {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: {{ block.settings.avatar_bg_color }};
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    font-weight: 600;
    color: {{ block.settings.avatar_text_color }};
    flex-shrink: 0;
  }

  .ai-testimonial-slider__author-info-{{ ai_gen_id }} {
    flex-grow: 1;
  }

  .ai-testimonial-slider__author-name-{{ ai_gen_id }} {
    font-size: 16px;
    font-weight: 600;
    color: {{ block.settings.author_name_color }};
    margin: 0 0 5px;
  }

  .ai-testimonial-slider__author-title-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.author_title_color }};
    margin: 0;
  }

  .ai-testimonial-slider__controls-{{ ai_gen_id }} {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-top: 40px;
  }

  .ai-testimonial-slider__button-{{ ai_gen_id }} {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: {{ block.settings.button_bg_color }};
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s ease;
  }

  .ai-testimonial-slider__button-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_bg_color }};
  }

  .ai-testimonial-slider__button-{{ ai_gen_id }}:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .ai-testimonial-slider__button-{{ ai_gen_id }} svg {
    width: 24px;
    height: 24px;
    color: {{ block.settings.button_icon_color }};
  }

  .ai-testimonial-slider__dots-{{ ai_gen_id }} {
    display: flex;
    gap: 10px;
  }

  .ai-testimonial-slider__dot-{{ ai_gen_id }} {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background-color: {{ block.settings.dot_color }};
    border: none;
    cursor: pointer;
    padding: 0;
    transition: background-color 0.3s ease;
  }

  .ai-testimonial-slider__dot-{{ ai_gen_id }}.active {
    background-color: {{ block.settings.dot_active_color }};
  }

  @media screen and (max-width: 749px) {
    .ai-testimonial-slider-{{ ai_gen_id }} {
      padding: 40px 20px;
    }

    .ai-testimonial-slider__header-{{ ai_gen_id }} {
      margin-bottom: 30px;
    }

    .ai-testimonial-slider__slide-{{ ai_gen_id }} {
      flex: 0 0 100%;
    }

    .ai-testimonial-slider__controls-{{ ai_gen_id }} {
      margin-top: 30px;
    }
  }

  @media screen and (min-width: 750px) and (max-width: 989px) {
    .ai-testimonial-slider__slide-{{ ai_gen_id }} {
      flex: 0 0 calc(50% - 10px);
    }
  }
{% endstyle %}

<testimonial-slider-{{ ai_gen_id }} class="ai-testimonial-slider-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-testimonial-slider__container-{{ ai_gen_id }}">
    {% if block.settings.title != blank or block.settings.subtitle != blank %}
      <div class="ai-testimonial-slider__header-{{ ai_gen_id }}">
        {% if block.settings.title != blank %}
          <h2 class="ai-testimonial-slider__title-{{ ai_gen_id }}">{{ block.settings.title }}</h2>
        {% endif %}
        {% if block.settings.subtitle != blank %}
          <p class="ai-testimonial-slider__subtitle-{{ ai_gen_id }}">{{ block.settings.subtitle }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="ai-testimonial-slider__track-wrapper-{{ ai_gen_id }}">
      <div class="ai-testimonial-slider__track-{{ ai_gen_id }}" data-track>
        {% for i in (1..6) %}
          {% liquid
            assign testimonial_enabled_key = 'testimonial_' | append: i | append: '_enabled'
            assign testimonial_quote_key = 'testimonial_' | append: i | append: '_quote'
            assign testimonial_name_key = 'testimonial_' | append: i | append: '_name'
            assign testimonial_title_key = 'testimonial_' | append: i | append: '_title'
            assign testimonial_rating_key = 'testimonial_' | append: i | append: '_rating'

            assign testimonial_enabled = block.settings[testimonial_enabled_key]
            assign testimonial_quote = block.settings[testimonial_quote_key]
            assign testimonial_name = block.settings[testimonial_name_key]
            assign testimonial_title = block.settings[testimonial_title_key]
            assign testimonial_rating = block.settings[testimonial_rating_key]
          %}

          {% if testimonial_enabled %}
            <div class="ai-testimonial-slider__slide-{{ ai_gen_id }}">
              <div class="ai-testimonial-slider__rating-{{ ai_gen_id }}">
                {% for star in (1..testimonial_rating) %}
                  <svg class="ai-testimonial-slider__star-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                  </svg>
                {% endfor %}
              </div>

              <p class="ai-testimonial-slider__quote-{{ ai_gen_id }}">{{ testimonial_quote }}</p>

              <div class="ai-testimonial-slider__author-{{ ai_gen_id }}">
                <div class="ai-testimonial-slider__avatar-{{ ai_gen_id }}">
                  {{ testimonial_name | slice: 0 }}
                </div>
                <div class="ai-testimonial-slider__author-info-{{ ai_gen_id }}">
                  <p class="ai-testimonial-slider__author-name-{{ ai_gen_id }}">{{ testimonial_name }}</p>
                  <p class="ai-testimonial-slider__author-title-{{ ai_gen_id }}">{{ testimonial_title }}</p>
                </div>
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div class="ai-testimonial-slider__controls-{{ ai_gen_id }}">
      <button class="ai-testimonial-slider__button-{{ ai_gen_id }}" data-prev aria-label="Previous testimonial">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>

      <div class="ai-testimonial-slider__dots-{{ ai_gen_id }}" data-dots></div>

      <button class="ai-testimonial-slider__button-{{ ai_gen_id }}" data-next aria-label="Next testimonial">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>
  </div>
</testimonial-slider-{{ ai_gen_id }}>

<script>
  (function() {
    class TestimonialSlider{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.currentIndex = 0;
        this.slidesPerView = 3;
      }

      connectedCallback() {
        this.track = this.querySelector('[data-track]');
        this.slides = Array.from(this.track.children);
        this.prevButton = this.querySelector('[data-prev]');
        this.nextButton = this.querySelector('[data-next]');
        this.dotsContainer = this.querySelector('[data-dots]');

        this.updateSlidesPerView();
        this.createDots();
        this.updateSlider();
        this.setupEventListeners();

        window.addEventListener('resize', () => {
          this.updateSlidesPerView();
          this.createDots();
          this.updateSlider();
        });
      }

      updateSlidesPerView() {
        if (window.innerWidth < 750) {
          this.slidesPerView = 1;
        } else if (window.innerWidth < 990) {
          this.slidesPerView = 2;
        } else {
          this.slidesPerView = 3;
        }
      }

      createDots() {
        this.dotsContainer.innerHTML = '';
        const totalDots = Math.ceil(this.slides.length / this.slidesPerView);

        for (let i = 0; i < totalDots; i++) {
          const dot = document.createElement('button');
          dot.classList.add('ai-testimonial-slider__dot-{{ ai_gen_id }}');
          dot.setAttribute('aria-label', 'Go to slide ' + (i + 1));
          dot.addEventListener('click', () => {
            this.currentIndex = i;
            this.updateSlider();
          });
          this.dotsContainer.appendChild(dot);
        }
      }

      setupEventListeners() {
        this.prevButton.addEventListener('click', () => {
          if (this.currentIndex > 0) {
            this.currentIndex--;
            this.updateSlider();
          }
        });

        this.nextButton.addEventListener('click', () => {
          const maxIndex = Math.ceil(this.slides.length / this.slidesPerView) - 1;
          if (this.currentIndex < maxIndex) {
            this.currentIndex++;
            this.updateSlider();
          }
        });
      }

      updateSlider() {
        const slideWidth = this.slides[0].offsetWidth;
        const gap = 20;
        const offset = -(this.currentIndex * this.slidesPerView * (slideWidth + gap));
        this.track.style.transform = 'translateX(' + offset + 'px)';

        const maxIndex = Math.ceil(this.slides.length / this.slidesPerView) - 1;
        this.prevButton.disabled = this.currentIndex === 0;
        this.nextButton.disabled = this.currentIndex === maxIndex;

        const dots = this.dotsContainer.querySelectorAll('.ai-testimonial-slider__dot-{{ ai_gen_id }}');
        dots.forEach((dot, index) => {
          if (index === this.currentIndex) {
            dot.classList.add('active');
          } else {
            dot.classList.remove('active');
          }
        });
      }
    }

    customElements.define('testimonial-slider-{{ ai_gen_id }}', TestimonialSlider{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Testimonial slider",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Section header"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "What Our Customers Say"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Don't just take our word for it"
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Title size",
      "default": 36
    },
    {
      "type": "range",
      "id": "subtitle_size",
      "min": 12,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Subtitle size",
      "default": 18
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#f9f9f9"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Subtitle",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Card background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "quote_color",
      "label": "Quote text",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "star_color",
      "label": "Star rating",
      "default": "#ffc107"
    },
    {
      "type": "color",
      "id": "author_name_color",
      "label": "Author name",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "author_title_color",
      "label": "Author title",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "avatar_bg_color",
      "label": "Avatar background",
      "default": "#264463"
    },
    {
      "type": "color",
      "id": "avatar_text_color",
      "label": "Avatar text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Card style"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 10
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Button background",
      "default": "#264463"
    },
    {
      "type": "color",
      "id": "button_hover_bg_color",
      "label": "Button hover background",
      "default": "#1a2f45"
    },
    {
      "type": "color",
      "id": "button_icon_color",
      "label": "Button icon",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "dot_color",
      "label": "Dot",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "dot_active_color",
      "label": "Active dot",
      "default": "#264463"
    },
    {
      "type": "header",
      "content": "Testimonial 1"
    },
    {
      "type": "checkbox",
      "id": "testimonial_1_enabled",
      "label": "Enable testimonial 1",
      "default": true
    },
    {
      "type": "textarea",
      "id": "testimonial_1_quote",
      "label": "Quote",
      "default": "This product exceeded my expectations! The quality is outstanding and the customer service was exceptional. Highly recommend to anyone looking for premium products."
    },
    {
      "type": "text",
      "id": "testimonial_1_name",
      "label": "Customer name",
      "default": "Sarah Johnson"
    },
    {
      "type": "text",
      "id": "testimonial_1_title",
      "label": "Customer title",
      "default": "Verified Buyer"
    },
    {
      "type": "range",
      "id": "testimonial_1_rating",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Rating",
      "default": 5
    },
    {
      "type": "header",
      "content": "Testimonial 2"
    },
    {
      "type": "checkbox",
      "id": "testimonial_2_enabled",
      "label": "Enable testimonial 2",
      "default": true
    },
    {
      "type": "textarea",
      "id": "testimonial_2_quote",
      "label": "Quote",
      "default": "I've been a customer for over a year now and I'm consistently impressed. Fast shipping, great prices, and the products always arrive in perfect condition."
    },
    {
      "type": "text",
      "id": "testimonial_2_name",
      "label": "Customer name",
      "default": "Michael Chen"
    },
    {
      "type": "text",
      "id": "testimonial_2_title",
      "label": "Customer title",
      "default": "Loyal Customer"
    },
    {
      "type": "range",
      "id": "testimonial_2_rating",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Rating",
      "default": 5
    },
    {
      "type": "header",
      "content": "Testimonial 3"
    },
    {
      "type": "checkbox",
      "id": "testimonial_3_enabled",
      "label": "Enable testimonial 3",
      "default": true
    },
    {
      "type": "textarea",
      "id": "testimonial_3_quote",
      "label": "Quote",
      "default": "Absolutely love my purchase! The attention to detail is remarkable and it's clear that quality is a top priority. Will definitely be ordering again soon."
    },
    {
      "type": "text",
      "id": "testimonial_3_name",
      "label": "Customer name",
      "default": "Emily Rodriguez"
    },
    {
      "type": "text",
      "id": "testimonial_3_title",
      "label": "Customer title",
      "default": "Happy Customer"
    },
    {
      "type": "range",
      "id": "testimonial_3_rating",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Rating",
      "default": 5
    },
    {
      "type": "header",
      "content": "Testimonial 4"
    },
    {
      "type": "checkbox",
      "id": "testimonial_4_enabled",
      "label": "Enable testimonial 4",
      "default": true
    },
    {
      "type": "textarea",
      "id": "testimonial_4_quote",
      "label": "Quote",
      "default": "Best shopping experience I've had online. The website is easy to navigate, checkout was smooth, and my order arrived earlier than expected. Five stars!"
    },
    {
      "type": "text",
      "id": "testimonial_4_name",
      "label": "Customer name",
      "default": "David Thompson"
    },
    {
      "type": "text",
      "id": "testimonial_4_title",
      "label": "Customer title",
      "default": "Satisfied Customer"
    },
    {
      "type": "range",
      "id": "testimonial_4_rating",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Rating",
      "default": 5
    },
    {
      "type": "header",
      "content": "Testimonial 5"
    },
    {
      "type": "checkbox",
      "id": "testimonial_5_enabled",
      "label": "Enable testimonial 5",
      "default": true
    },
    {
      "type": "textarea",
      "id": "testimonial_5_quote",
      "label": "Quote",
      "default": "I was skeptical at first, but this completely changed my mind. The product quality is top-notch and the value for money is unbeatable. Highly recommended!"
    },
    {
      "type": "text",
      "id": "testimonial_5_name",
      "label": "Customer name",
      "default": "Jessica Martinez"
    },
    {
      "type": "text",
      "id": "testimonial_5_title",
      "label": "Customer title",
      "default": "First-time Buyer"
    },
    {
      "type": "range",
      "id": "testimonial_5_rating",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Rating",
      "default": 4
    },
    {
      "type": "header",
      "content": "Testimonial 6"
    },
    {
      "type": "checkbox",
      "id": "testimonial_6_enabled",
      "label": "Enable testimonial 6",
      "default": true
    },
    {
      "type": "textarea",
      "id": "testimonial_6_quote",
      "label": "Quote",
      "default": "Outstanding service from start to finish. The team went above and beyond to ensure I was completely satisfied. This is now my go-to store!"
    },
    {
      "type": "text",
      "id": "testimonial_6_name",
      "label": "Customer name",
      "default": "Robert Anderson"
    },
    {
      "type": "text",
      "id": "testimonial_6_title",
      "label": "Customer title",
      "default": "Regular Customer"
    },
    {
      "type": "range",
      "id": "testimonial_6_rating",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Rating",
      "default": 5
    }
  ],
  "presets": [
    {
      "name": "Testimonial slider"
    }
  ]
}
{% endschema %}
